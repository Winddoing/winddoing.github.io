---
layout: post
title: Graphics driver for Linux
date: '2020-06-18 10:21'
tags:
  - 显卡
  - 驱动
categories:
  - 软件使用
---

Graphics driver for Linux

<!--more-->


## NVIDIA for Centos7

> 为centos7安装[NVIDIA](https://www.nvidia.cn/Download/index.aspx?lang=cn)驱动程序

### 屏蔽系统自带的Nouveau显卡驱动

1. 通过vim编辑器更改配置文件，按照以下内容进行修改

> vim /lib/modprobe.d/dist-blacklist.conf

```
blacklist nouveau               #添加此行
options nouveau modeset=0       #添加此行
# blacklist nvidiafb            #将nvidiafb的这一行注释掉
```

2. 重建 initramfs image

```
# 备份
# mv /boot/initramfs-$(uname -r).img /boot/initramfs-$(uname -r).img.bak

# 重建
# dracut /boot/initramfs-$(uname -r).img $(uname -r)
```

3. 重启系统确认nouveau驱动没有被加载

```
# 修改系统运行级别为纯文本模式
# systemctl set-default multi-user.target

# 重启系统
# reboot

# 系统重启完成后，在纯文本模式下使用root用户登录进系统

# 查看nouveau显卡驱动是否已经被禁用，若此命令执行完之后没有输出相关信息，则说明已经被禁用
# lsmod | grep nouveau
```

### 安装NVIDIA驱动

设置下载的驱动文件可执行权限后,直接运行,安装过程中，选择accept；如果提示是否编译DKMS模块，选择yes（方便以后升级系统内核）；如果提示要修改xorg.conf，选择yes

在安装完后使用`nvidia-smi`测试查看显卡状态,并通过`startx`确认是否可以启动xorg进入桌面,有时可能需要在生成的`xorg.conf`中配置显卡驱动的PCI总线地址(注意:地址以十进制表示,需要将lspci的十六进制转换为十进制)

- 修改系统运行级别为图形模式
```
systemctl set-default graphical.target
```
