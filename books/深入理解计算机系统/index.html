<!DOCTYPE html><html lang=zh-CN><head><meta charset=UTF-8><meta name=viewport content="width=device-width"><meta name=theme-color content=#222 media="(prefers-color-scheme: light)"><meta name=theme-color content=#222 media="(prefers-color-scheme: dark)"><meta name=generator content="Hexo 6.2.0"><link rel=preconnect href=https://fonts.googleapis.com crossorigin><link rel=preconnect href=https://cdnjs.cloudflare.com crossorigin><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon-next.png><link rel=icon type=image/png sizes=32x32 href=/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/favicon.ico><link rel=mask-icon href=/images/logo.svg color=#222><meta name=baidu-site-verification content=WIIeufYjj6><link rel=stylesheet href=/css/main.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Microsoft+YaHei:300,300italic,400,400italic,700,700italic%7Ccmmi10:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin=anonymous><script class=next-config data-name=main type=application/json>{"hostname":"winddoing.github.io","root":"/","images":"/images","scheme":"Mist","darkmode":true,"version":"8.12.1","exturl":true,"sidebar":{"position":"right","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"default"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":"utterances","storage":true,"lazyload":false,"nav":null,"activeClass":"utterances"},"stickytabs":false,"motion":{"enable":true,"async":true,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src=/js/config.js></script><meta name=description content="存储器层次结构内存 静态RAM（SRAM） 动态RAM（DRAM） 闪存(flash memory):一类非易失性存储器,基于EEPROM(电子可擦除PROM(Electrically Erasable PROM)) 固件(firmware): 存储在ROM(Read-Only Memory)设备中的程序 I&#x2F;O桥的作用—翻译 I&#x2F;O桥将系统总线（system"><meta property=og:type content=website><meta property=og:title content=深入理解计算机系统><meta property=og:url content=https://winddoing.github.io/books/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/index.html><meta property=og:site_name content="Winddoing&#39;s Notes"><meta property=og:description content="存储器层次结构内存 静态RAM（SRAM） 动态RAM（DRAM） 闪存(flash memory):一类非易失性存储器,基于EEPROM(电子可擦除PROM(Electrically Erasable PROM)) 固件(firmware): 存储在ROM(Read-Only Memory)设备中的程序 I&#x2F;O桥的作用—翻译 I&#x2F;O桥将系统总线（system"><meta property=og:locale content=zh_CN><meta property=og:image content=https://winddoing.github.io/books/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/images/sram.JPG><meta property=og:image content=https://winddoing.github.io/books/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/images/dram.JPG><meta property=og:image content=https://winddoing.github.io/books/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/images/cpu_mem_bus.JPG><meta property=og:image content=https://winddoing.github.io/books/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/images/cpu_mem_disk.JPG><meta property=og:image content=https://winddoing.github.io/books/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/images/%E5%AD%98%E5%82%A8%E5%99%A8%E5%B1%82%E6%AC%A1%E7%BB%93%E6%9E%84.JPG><meta property=og:image content=https://winddoing.github.io/books/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/images/%E9%AB%98%E9%80%9F%E7%BC%93%E5%AD%98%E6%80%BB%E7%BA%BF%E6%9E%B6%E6%9E%84.JPG><meta property=og:image content=https://winddoing.github.io/books/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/images/cache_mem_addr_layout.png><meta property=og:image content=https://winddoing.github.io/books/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/images/cache_layout_struct.png><meta property=og:image content=https://winddoing.github.io/books/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/images/cache_set_index.JPG><meta property=og:image content=https://winddoing.github.io/books/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/images/sparc_cpu_core.JPG><meta property=article:published_time content=2019-05-07T14:23:24.000Z><meta property=article:modified_time content=2023-12-16T04:58:17.941Z><meta property=article:author content=winddoing><meta property=article:tag content=winddoing,嵌入式,Linux,kernel,shell,C语言,网络,mips,arm,arm64,虚拟化><meta name=twitter:card content=summary><meta name=twitter:image content=https://winddoing.github.io/books/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/images/sram.JPG><link rel=canonical href="https://winddoing.github.io/books/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/"><script class=next-config data-name=page type=application/json>{"sidebar":"","isHome":false,"isPost":false,"lang":"zh-CN","comments":"","permalink":"https://winddoing.github.io/books/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/index.html","path":"books/深入理解计算机系统/index.html","title":"深入理解计算机系统"}</script><script class=next-config data-name=calendar type=application/json>""</script><title>深入理解计算机系统 | Winddoing's Notes</title><script src=/js/third-party/analytics/baidu-analytics.js></script><script async src=https://hm.baidu.com/hm.js?b96a560ce0a6bfbeaaddc59dc5888b75></script><noscript><link rel=stylesheet href=/css/noscript.css></noscript></head><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label=切换导航栏 role=button><span class=toggle-line></span> <span class=toggle-line></span> <span class=toggle-line></span></div></div><div class=site-meta><a href="/" class=brand rel=start><i class=logo-line></i><p class=site-title>Winddoing's Notes</p><i class=logo-line></i></a><p class=site-subtitle itemprop=description>Follow Excellent, Success will Chase you</p></div><div class=site-nav-right><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel=section><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel=section><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel=section><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel=section><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-search"><a role=button class=popup-trigger><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon><i class="fa fa-search"></i></span><div class=search-input-container><input autocomplete=off autocapitalize=off maxlength=80 placeholder=搜索... spellcheck=false type=search class=search-input></div><span class=popup-btn-close role=button><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span> <span class=toggle-line></span> <span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录</li><li class=sidebar-nav-overview>站点概览</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class=nav><li class="nav-item nav-level-1"><a class=nav-link href=#%E5%AD%98%E5%82%A8%E5%99%A8%E5%B1%82%E6%AC%A1%E7%BB%93%E6%9E%84><span class=nav-number>1.</span> <span class=nav-text>存储器层次结构</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#%E5%86%85%E5%AD%98><span class=nav-number>1.1.</span> <span class=nav-text>内存</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#%E7%A4%BA%E4%BE%8B%EF%BC%9A%E8%AF%BB%E5%8F%96%E5%86%85%E5%AD%98%E6%95%B0%E6%8D%AE><span class=nav-number>1.1.1.</span> <span class=nav-text>示例：读取内存数据</span></a></li></ol></li><li class="nav-item nav-level-2"><a class=nav-link href=#%E7%A3%81%E7%9B%98%E5%AD%98%E5%82%A8><span class=nav-number>1.2.</span> <span class=nav-text>磁盘存储</span></a></li><li class="nav-item nav-level-2"><a class=nav-link href=#%E5%B1%80%E9%83%A8%E6%80%A7><span class=nav-number>1.3.</span> <span class=nav-text>局部性</span></a></li><li class="nav-item nav-level-2"><a class=nav-link href=#%E5%AD%98%E5%82%A8%E5%99%A8%E5%B1%82%E6%AC%A1%E7%BB%93%E6%9E%84-1><span class=nav-number>1.4.</span> <span class=nav-text>存储器层次结构</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#%E7%BC%93%E5%AD%98><span class=nav-number>1.4.1.</span> <span class=nav-text>缓存</span></a></li><li class="nav-item nav-level-3"><a class=nav-link href=#%E7%BC%93%E5%AD%98%E7%AE%A1%E7%90%86><span class=nav-number>1.4.2.</span> <span class=nav-text>缓存管理</span></a></li></ol></li><li class="nav-item nav-level-2"><a class=nav-link href=#%E9%AB%98%E9%80%9F%E7%BC%93%E5%AD%98%E5%AD%98%E5%82%A8%E5%99%A8><span class=nav-number>1.5.</span> <span class=nav-text>高速缓存存储器</span></a><ol class=nav-child><li class="nav-item nav-level-3"><a class=nav-link href=#%E9%80%9A%E7%94%A8%E7%9A%84%E9%AB%98%E9%80%9F%E7%BC%93%E5%AD%98%E5%AD%98%E5%82%A8%E5%99%A8%E7%BB%93%E6%9E%84><span class=nav-number>1.5.1.</span> <span class=nav-text>通用的高速缓存存储器结构</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E7%9B%B8%E5%85%B3%E5%8F%82%E6%95%B0><span class=nav-number>1.5.1.1.</span> <span class=nav-text>相关参数</span></a></li><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%9C%B0%E5%9D%80%E6%A3%80%E7%B4%A2%E6%B5%81%E7%A8%8B><span class=nav-number>1.5.1.2.</span> <span class=nav-text>地址检索流程</span></a></li><li class="nav-item nav-level-4"><a class=nav-link href=#%E4%B8%BA%E4%BB%80%E4%B9%88%E7%94%A8%E4%B8%AD%E9%97%B4%E7%9A%84%E4%BD%8D%E5%81%9A%E7%B4%A2%E5%BC%95%EF%BC%9F><span class=nav-number>1.5.1.3.</span> <span class=nav-text>为什么用中间的位做索引？</span></a></li></ol></li><li class="nav-item nav-level-3"><a class=nav-link href=#%E7%9B%B4%E6%8E%A5%E6%98%A0%E5%B0%84%E9%AB%98%E9%80%9F%E7%BC%93%E5%AD%98%EF%BC%88direct-mapped-cache%EF%BC%89><span class=nav-number>1.5.2.</span> <span class=nav-text>直接映射高速缓存（direct-mapped cache）</span></a></li><li class="nav-item nav-level-3"><a class=nav-link href=#%E7%BB%84%E7%9B%B8%E8%81%94%E9%AB%98%E9%80%9F%E7%BC%93%E5%AD%98><span class=nav-number>1.5.3.</span> <span class=nav-text>组相联高速缓存</span></a></li><li class="nav-item nav-level-3"><a class=nav-link href=#%E5%85%A8%E7%9B%B8%E8%81%94%E9%AB%98%E9%80%9F%E7%BC%93%E5%AD%98><span class=nav-number>1.5.4.</span> <span class=nav-text>全相联高速缓存</span></a></li><li class="nav-item nav-level-3"><a class=nav-link href=#%E6%9C%89%E5%85%B3%E5%86%99%E7%9A%84%E9%97%AE%E9%A2%98><span class=nav-number>1.5.5.</span> <span class=nav-text>有关写的问题</span></a><ol class=nav-child><li class="nav-item nav-level-4"><a class=nav-link href=#%E5%86%99%E4%B8%8D%E5%91%BD%E4%B8%AD%E5%A4%84%E7%90%86><span class=nav-number>1.5.5.1.</span> <span class=nav-text>写不命中处理</span></a></li><li class="nav-item nav-level-4"><a class=nav-link href=#Write-x2F-Store-Buffer><span class=nav-number>1.5.5.2.</span> <span class=nav-text>Write&#x2F;Store Buffer</span></a></li></ol></li><li class="nav-item nav-level-3"><a class=nav-link href=#%E9%AB%98%E9%80%9F%E7%BC%93%E5%AD%98%E5%8F%82%E6%95%B0%E7%9A%84%E6%80%A7%E8%83%BD%E5%BD%B1%E5%93%8D><span class=nav-number>1.5.6.</span> <span class=nav-text>高速缓存参数的性能影响</span></a></li></ol></li><li class="nav-item nav-level-2"><a class=nav-link href=#%E5%8F%82%E8%80%83><span class=nav-number>1.6.</span> <span class=nav-text>参考</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=winddoing src=/images/Winddoing.jpg><p class=site-author-name itemprop=name>winddoing</p><div class=site-description itemprop=description>失败缘于忽视细处，成功始于重视小事</div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href="/archives/"><span class=site-state-item-count>358</span> <span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class=site-state-item-count>112</span> <span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class=site-state-item-count>284</span> <span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-author site-overview-item animated"><span class=links-of-author-item><span class=exturl data-url="aHR0cHM6Ly9naXRodWIuY29tL1dpbmRkb2luZw==" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Winddoing"><i class="fab fa-github fa-fw"></i>GitHub</span></span> <span class=links-of-author-item><span class=exturl data-url=aHR0cHM6Ly9naXRlZS5jb20vd2luZGRvaW5n title="Gitee → https:&#x2F;&#x2F;gitee.com&#x2F;winddoing"><i class="fab fa-codiepie fa-fw"></i>Gitee</span></span> <span class=links-of-author-item><span class=exturl data-url="aHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS91c2Vycy85NTY3MzYxL3dpbmRkb2luZw==" title="StackOverflow → https:&#x2F;&#x2F;stackoverflow.com&#x2F;users&#x2F;9567361&#x2F;winddoing"><i class="fab fa-stack-overflow fa-fw"></i>StackOverflow</span></span> <span class=links-of-author-item><span class=exturl data-url="aHR0cHM6Ly9hcHAudHJhdmlzLWNpLmNvbS9naXRodWIvV2luZGRvaW5nL3dpbmRkb2luZy5naXRodWIuaW8=" title="Travis CI → https:&#x2F;&#x2F;app.travis-ci.com&#x2F;github&#x2F;Winddoing&#x2F;winddoing.github.io"><i class="fas fa-terminal fa-fw"></i>Travis CI</span></span></div><div class="cc-license site-overview-item animated" itemprop=license><span class="exturl cc-opacity" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC8="><img src=https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg alt="Creative Commons"></span></div><div class="links-of-blogroll site-overview-item animated"><div class=links-of-blogroll-title><i class="link fa-fw"></i> Links</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><span class=exturl data-url="aHR0cHM6Ly93aW5kZG9pbmcuZ2l0Ym9vay5pby9lbWJlZGRlZF9saW51eF9ub3Rlcy8=" title=https:&#x2F;&#x2F;winddoing.gitbook.io&#x2F;embedded_linux_notes&#x2F;>嵌入式相关</span></li><li class=links-of-blogroll-item><span class=exturl data-url="aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc2RyZWFtcQ==" title=http:&#x2F;&#x2F;blog.csdn.net&#x2F;sdreamq>CSDN</span></li><li class=links-of-blogroll-item><span class=exturl data-url=aHR0cDovL3d3dy53b3dvdGVjaC5uZXQv title=http:&#x2F;&#x2F;www.wowotech.net&#x2F;>蜗窝科技</span></li><li class=links-of-blogroll-item><span class=exturl data-url=aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3hpb25neGlhbnpl title=https:&#x2F;&#x2F;blog.csdn.net&#x2F;xiongxianze>xiongxianze</span></li></ul></div><div id=days></div><script>
function show_date_time(){
    window.setTimeout("show_date_time()", 1000);
    BirthDay=new Date("02/26/2014 15:00:00");
    today=new Date();
    timeold=(today.getTime()-BirthDay.getTime());
    sectimeold=timeold/1000
        secondsold=Math.floor(sectimeold);
    msPerDay=24*60*60*1000
        e_daysold=timeold/msPerDay
        daysold=Math.floor(e_daysold);
    e_hrsold=(e_daysold-daysold)*24;
    hrsold=setzero(Math.floor(e_hrsold));
    e_minsold=(e_hrsold-hrsold)*60;
    minsold=setzero(Math.floor((e_hrsold-hrsold)*60));
    seconds=setzero(Math.floor((e_minsold-minsold)*60));
    document.getElementById('days').innerHTML="已运行"+daysold+"天"+hrsold+"小时"+minsold+"分"+seconds+"秒";
}
function setzero(i){
    if (i<10)
    {i="0" + i};
    return i;
}
show_date_time();
</script></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=back-to-top role=button aria-label=返回顶部><i class="fa fa-arrow-up"></i> <span>0%</span></div><div class=reading-progress-bar></div><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner page posts-expand"><div class=post-block lang=zh-CN><header class=post-header><h1 class=post-title itemprop="name headline">深入理解计算机系统</h1><div class=post-meta-container><ul class=breadcrumb><li><a href="/books/">BOOKS</a></li><li>深入理解计算机系统</li></ul></div></header><div class=post-body><h1 id=存储器层次结构><a href=#存储器层次结构 class=headerlink title=存储器层次结构></a>存储器层次结构</h1><h2 id=内存><a href=#内存 class=headerlink title=内存></a>内存</h2><ul><li>静态RAM（SRAM）</li></ul><p><img data-src=/books/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/images/sram.JPG alt=SRAM></p><ul><li>动态RAM（DRAM）</li></ul><p><img data-src=/books/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/images/dram.JPG alt=DRAM></p><ul><li><code>闪存</code>(flash memory):一类非易失性存储器,基于<code>EEPROM</code>(电子可擦除PROM(Electrically Erasable PROM))</li><li><code>固件</code>(firmware): 存储在ROM(Read-Only Memory)设备中的程序</li></ul><p><img data-src=/books/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/images/cpu_mem_bus.JPG alt="CPU MEM BUS"></p><ul><li>I&#x2F;O桥的作用—<code>翻译</code><blockquote><p>I&#x2F;O桥将系统总线（system bus）的电子信号翻译成存储器总线（memory bus）的电子信号</p></blockquote></li></ul><h3 id=示例：读取内存数据><a href=#示例：读取内存数据 class=headerlink title=示例：读取内存数据></a>示例：读取内存数据</h3><figure class="highlight plaintext"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><span class=line>movl A %eax</span><br></pre></td></tr></table></figure><blockquote><p>将地址A的内容加载到寄存器%eax中</p></blockquote><ul><li>CPU将地址A放到存储总线上</li><li>主存从总线读取A，取出字x，然后将x放到总线上</li><li>CPU从总线上读出字x，并将其拷贝到寄存器%eax中</li></ul><h2 id=磁盘存储><a href=#磁盘存储 class=headerlink title=磁盘存储></a>磁盘存储</h2><p><img data-src=/books/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/images/cpu_mem_disk.JPG alt="CPU MEM DISK"></p><p>读磁盘操作：</p><ul><li>CPU通过命令、逻辑块号和目的存储器地址写到与磁盘相关的存储器映射地址，发起一个磁盘读操作</li><li>磁盘控制器读扇区，并执行到主存的DMA传送</li><li>当DMA传送完成时，磁盘控制器用<code>中断</code>的方式通知CPU</li></ul><h2 id=局部性><a href=#局部性 class=headerlink title=局部性></a>局部性</h2><blockquote><p><code>局部性原理</code>：编写程序时，倾向于引用邻近于其他最近引用过的数据项的数据项，或者最近引用过的数据项本身。</p></blockquote><p>局部性：时间局部性（temporal locality）和空间局部性（spatial locality）</p><ul><li>时间局部性：被引用过一次的存储位置很可能在不远的将来再被多次引用</li><li>空间局部性：如果一个存储位置被引用一次，那么程序很可能在不远的将来引用附近的一个存储器位置</li></ul><p>局部性原理允许计算机设计者通过引入称为的<code>高速缓存存储器</code>的小而快速的存储器来保存最近被引用的指令和数据项，从而提高对主存的访问速度。</p><h2 id=存储器层次结构-1><a href=#存储器层次结构-1 class=headerlink title=存储器层次结构></a>存储器层次结构</h2><p><img data-src=/books/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/images/%E5%AD%98%E5%82%A8%E5%99%A8%E5%B1%82%E6%AC%A1%E7%BB%93%E6%9E%84.JPG alt=存储器层次结构></p><h3 id=缓存><a href=#缓存 class=headerlink title=缓存></a>缓存</h3><p>高速缓存（cache）是一个小而快速的存储设备，它作为存储在更大、也更慢的设备中的数据对象的缓冲区域。</p><blockquote><p>缓存（caching）：使用高速缓存的过程</p></blockquote><ul><li>缓存命中（Cache Hit）</li><li>缓存不命中（Cache Miss）<ul><li>覆盖现有缓存的块的过程叫<code>替换</code>（replacing）或<code>驱逐</code>（evicting）</li><li><code>替换策略</code>（replacement policy）: 最近最少被使用（LRU）替换策略的缓存选择那个最后被访问的时间距现在最远的块</li></ul></li></ul><h3 id=缓存管理><a href=#缓存管理 class=headerlink title=缓存管理></a>缓存管理</h3><p>存储器分层结构的本质: <code>每一层存储设备都是较低一层的缓存</code></p><blockquote><ul><li>L1、L2、L3层的缓存完全是由内置在缓存中的硬件逻辑来管理</li><li>DRAM主存作为存储在磁盘上数据块的缓存，是由<code>操作系统</code>软件和<code>CPU上的地址翻译硬件</code>(TLB)共同管理</li></ul></blockquote><table><thead><tr><th align=center>类型</th><th align=center>缓存什么</th><th align=center>被缓存在何处</th><th align=center>延迟（周期数）</th><th align=center>由谁管理</th></tr></thead><tbody><tr><td align=center>CPU寄存器</td><td align=center>4字节或8字节字</td><td align=center>芯片上的CPU寄存器</td><td align=center>0</td><td align=center>编译器</td></tr><tr><td align=center>TLB</td><td align=center>地址翻译</td><td align=center>芯片上的TLB</td><td align=center>0</td><td align=center>硬件MMU</td></tr><tr><td align=center>L1高速缓存</td><td align=center>64字节块</td><td align=center>芯片上的L1高速缓存</td><td align=center>1</td><td align=center>硬件</td></tr><tr><td align=center>L2高速缓存</td><td align=center>64字节块</td><td align=center>芯片上&#x2F;下的L2高速缓存</td><td align=center>10</td><td align=center>硬件</td></tr><tr><td align=center>L3高速缓存</td><td align=center>64字节块</td><td align=center>芯片上&#x2F;下的L3高速缓存</td><td align=center>30</td><td align=center>硬件</td></tr><tr><td align=center>虚拟存储器</td><td align=center>4KB</td><td align=center>主存</td><td align=center>100</td><td align=center>硬件+OS</td></tr><tr><td align=center>缓冲区存储</td><td align=center>部分文件</td><td align=center>主存</td><td align=center>100</td><td align=center>OS</td></tr><tr><td align=center>磁盘缓存</td><td align=center>磁盘扇区</td><td align=center>磁盘控制器</td><td align=center>100 000</td><td align=center>控制器固件</td></tr><tr><td align=center>网络缓存</td><td align=center>部分文件</td><td align=center>本地磁盘</td><td align=center>10 000 000</td><td align=center>AFS&#x2F;NFS客户端</td></tr></tbody></table><blockquote><p>TLB: 翻译后备缓冲器（Translation Lookaside Buffer）</p><ul><li>延迟周期随CPU性能的提高越来越短</li></ul></blockquote><h2 id=高速缓存存储器><a href=#高速缓存存储器 class=headerlink title=高速缓存存储器></a>高速缓存存储器</h2><p><img data-src=/books/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/images/%E9%AB%98%E9%80%9F%E7%BC%93%E5%AD%98%E6%80%BB%E7%BA%BF%E6%9E%B6%E6%9E%84.JPG alt=高速缓存总线架构></p><h3 id=通用的高速缓存存储器结构><a href=#通用的高速缓存存储器结构 class=headerlink title=通用的高速缓存存储器结构></a>通用的高速缓存存储器结构</h3><p>在CPU中存储器地址线的个数m，将决定其寻址的范围<code>$M=2^m$</code>个不同的地址。</p><p>高速缓存主要是将主存中的数据以一定的方式或者策略映射其中，以提高CPU的读写速度，减少数据访问周期。而映射到在Cache中的数据可以被CPU访问同样是通过地址检索，为了提高CPU检索的速度，将地址进行了划分，分成不同的组（Cache set），每个组分成不同行（Cache line）， 每个行分成不同的数据块（block）来提高访问速度。</p><p>地址划分如下：<br><img data-src=/books/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/images/cache_mem_addr_layout.png alt=Cache内存地址划分></p><table><thead><tr><th align=center>类型</th><th align=center>位宽</th><th align=left>含义</th></tr></thead><tbody><tr><td align=center>标记(tag)</td><td align=center>t</td><td align=left>用来确定该地址属于哪个高速缓存行（Cache line）</td></tr><tr><td align=center>组索引(index)</td><td align=center>s</td><td align=left>用来确定该地址属于哪个高速缓存组（Cache set）</td></tr><tr><td align=center>块偏移(offset)</td><td align=center>b</td><td align=left>用来确定该地址属于高速缓存行中的哪个数据块（block）</td></tr></tbody></table><blockquote><p>注： m &#x3D; t + s + b</p></blockquote><p>不同的分类将Cache组织起来，高速缓存（S，E, B, m）的通用组织：<br><img data-src=/books/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/images/cache_layout_struct.png alt=高速缓存通用组织><br>高速缓存是一个高速缓存组（Cache set）的数组，每一个组包含一个或多个行，每个行包含一个有效位、一些标记位、以及一个数据块</p><blockquote><p>高速缓存的大小：<code>C = S x E x B</code></p></blockquote><h4 id=相关参数><a href=#相关参数 class=headerlink title=相关参数></a>相关参数</h4><table><thead><tr><th align=center>参数</th><th align=left>描述</th></tr></thead><tbody><tr><td align=center>$S&#x3D;2^s$</td><td align=left>组数</td></tr><tr><td align=center>$E$</td><td align=left>每个组行数</td></tr><tr><td align=center>$B&#x3D;2^b$</td><td align=left>块大小（字节）</td></tr><tr><td align=center>$m&#x3D;log_2(M)$</td><td align=left>(主存物理地址位数)</td></tr><tr><td align=center>$M&#x3D;2^m$</td><td align=left>存储器地址最大数量</td></tr><tr><td align=center>$s&#x3D;log_2(S)$</td><td align=left>组索引位数量</td></tr><tr><td align=center>$b&#x3D;log_2(B)$</td><td align=left>块偏移位数量</td></tr><tr><td align=center>$t&#x3D;m-(s+b)$</td><td align=left>标记位数量</td></tr><tr><td align=center>$C&#x3D;S\times E\times B$</td><td align=left>不包含有效位和标记位这样开销的高速缓存大小（字节）</td></tr></tbody></table><h4 id=地址检索流程><a href=#地址检索流程 class=headerlink title=地址检索流程></a>地址检索流程</h4><ol><li>组选择，依据<code>组索引</code></li><li>行匹配，依据<code>标记位</code></li><li>字抽取，依据<code>块偏移</code></li></ol><h4 id=为什么用中间的位做索引？><a href=#为什么用中间的位做索引？ class=headerlink title=为什么用中间的位做索引？></a>为什么用中间的位做索引？</h4><p>如果使用高位做索引，那么一些连续的存储器块就会映射到相同的高速缓存块中<br><img data-src=/books/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/images/cache_set_index.JPG alt=组索引></p><h3 id=直接映射高速缓存（direct-mapped-cache）><a href=#直接映射高速缓存（direct-mapped-cache） class=headerlink title="直接映射高速缓存（direct-mapped cache）"></a>直接映射高速缓存（direct-mapped cache）</h3><blockquote><p>每一个组中只有一行高速缓存（E&#x3D;1）</p></blockquote><ul><li>缓存命中（Cache hit）</li><li>缓存不命中（Cache miss）<ul><li>需要从存储器层次结构中的下一层取出被请求的块，然后将新块存储在组索引位指示的组中的一个高速缓存行中。由于直接映射组中只有一个高速缓存行，因此可以直接替换。</li></ul></li></ul><blockquote><p>直接映射高速缓存中容易产生<code>冲突不命中</code>,从而降低高速缓存的性能</p></blockquote><h3 id=组相联高速缓存><a href=#组相联高速缓存 class=headerlink title=组相联高速缓存></a>组相联高速缓存</h3><blockquote><p>每组都保存有多于一个的高速缓存行，一个<code>1&lt;E&lt;C/B</code>的高速缓存通常称为<code>E路高速缓存</code></p></blockquote><ul><li>缓存命中（Cache hit）</li><li>缓存不命中（Cache miss）<ul><li>替换策略：<ul><li>最不常使用(Least-Frequently-Used, LFU)</li><li>最近最少使用(Least-Recently-Used, LRU)</li></ul></li></ul></li></ul><h3 id=全相联高速缓存><a href=#全相联高速缓存 class=headerlink title=全相联高速缓存></a>全相联高速缓存</h3><blockquote><p>由一个包含所有高速缓存行的组（即E&#x3D;C&#x2F;B）组成的</p></blockquote><p>因为只有一个组，所以此时就没有组索引位s&#x3D;</p><h3 id=有关写的问题><a href=#有关写的问题 class=headerlink title=有关写的问题></a>有关写的问题</h3><ul><li>直写(write-through): 就是立即将改动的高速缓存块写回到紧接着的底一层中<ul><li>缺点就是每次写都会引起总线流量</li></ul></li><li>回写(write-back): 尽可能的推迟存储器更新，只有当替换算法要替换更新过的块时，才把他写入紧接着的底一层中。<ul><li>缺点增加复杂度，高速缓存必须为每一个高速缓存行维护一个额外的<code>修改位(dirty bit)</code>，表明这个高速缓存行是否被修改过</li></ul></li></ul><h4 id=写不命中处理><a href=#写不命中处理 class=headerlink title=写不命中处理></a>写不命中处理</h4><ul><li>写分配(write-allocate)：加载相应的底一层中的块到高速缓存中，然后更新这个高速缓存</li><li>非写分配(not-write-allocate)：避开高速缓存，直接把这个字写到底一层中</li></ul><blockquote><p>直写高速缓存通常是非写分配； 回写高速缓存通常是写分配</p></blockquote><h4 id=Write-x2F-Store-Buffer><a href=#Write-x2F-Store-Buffer class=headerlink title="Write&#x2F;Store Buffer"></a>Write&#x2F;Store Buffer</h4><p>现代的处理器往往引入<code>Write/Store Buffer</code>来提升存储系统的性能。Write Buffer的位置位于<code>L1 D-Cache</code>与<code>下一级存储器</code>之间</p><blockquote><p>CPU架构：Open SPARC T1</p></blockquote><p><img data-src=/books/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/images/sparc_cpu_core.JPG alt="SPARC core"></p><p>引入Write Buffer，其优点在于当D-Cache的脏行被替换，数据写回时，此时Cache无需等待可以继续工作，即：其认为数据回写入 Write Buffer即认为此回写操作已完成，无需等待下一级存储器的缓慢响应。Write-through之Cache亦是如此。</p><h3 id=高速缓存参数的性能影响><a href=#高速缓存参数的性能影响 class=headerlink title=高速缓存参数的性能影响></a>高速缓存参数的性能影响</h3><ul><li>不命中率（miss rate）</li><li>命中率（hit rate）</li><li>命中时间（hit time）:从高速缓存传送一个字到CPU所需的时间，包括组选择、行确认和字选择时间</li><li>不命中处罚（miss penalty）</li></ul><h2 id=参考><a href=#参考 class=headerlink title=参考></a>参考</h2><ul><li><span class=exturl data-url="aHR0cHM6Ly93d3cub3JhY2xlLmNvbS90ZWNobmV0d29yay9zeXN0ZW1zL29wZW5zcGFyYy90MS0wMS1vcGVuc3BhcmN0MS1taWNyby1hcmNoLTE1Mzg5NTkuaHRtbA==">OpenSPARC™T1 Microarchitecture Specification<i class="fa fa-external-link-alt"></i></span></li></ul></div></div><ul class=breadcrumb><li><a href="/books/">BOOKS</a></li><li>深入理解计算机系统</li></ul></div></main><footer class=footer><div class=footer-inner><div class=copyright>&copy; 2014 – <span itemprop=copyrightYear>2023</span> <span class=with-love><i class="fa fa-heart"></i></span> <span class=author itemprop=copyrightHolder>winddoing</span></div><div class=wordcount><span class=post-meta-item><span class=post-meta-item-icon><i class="fa fa-chart-line"></i></span> <span title=站点总字数>1.1m</span></span> <span class=post-meta-item><span class=post-meta-item-icon><i class="fa fa-coffee"></i></span> <span title=站点阅读时长>16:21</span></span></div><div class=busuanzi-count><span class=post-meta-item id=busuanzi_container_site_uv><span class=post-meta-item-icon><i class="fa fa-users"></i></span> <span class=site-uv title=总访客量><span id=busuanzi_value_site_uv></span></span></span> <span class=post-meta-item id=busuanzi_container_site_pv><span class=post-meta-item-icon><i class="fa fa-eye"></i></span> <span class=site-pv title=总访问量><span id=busuanzi_value_site_pv></span></span></span></div><div class=powered-by>由 <span class=exturl data-url=aHR0cHM6Ly9oZXhvLmlv>Hexo</span> & <span class=exturl data-url="aHR0cHM6Ly90aGVtZS1uZXh0LmpzLm9yZy9taXN0Lw==">NexT.Mist</span> 强力驱动</div></div></footer><script src=https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.5.0/pjax.min.js integrity="sha256-3NkoLDrmHLTYj7csHIZSr0MHAFTXth7Ua/DDt4MRUAg=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" crossorigin=anonymous></script><script src=/js/comments.js></script><script src=/js/utils.js></script><script src=/js/motion.js></script><script src=/js/schemes/muse.js></script><script src=/js/next-boot.js></script><script src=/js/pjax.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.0/search.js integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin=anonymous></script><script src=/js/third-party/search/local-search.js></script><script class=next-config data-name=pdf type=application/json>{"object_url":{"url":"https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.2.8/pdfobject.min.js","integrity":"sha256-tu9j5pBilBQrWSDePOOajCUdz6hWsid/lBNzK4KgEPM="},"url":"/lib/pdf/web/viewer.html"}</script><script src=/js/third-party/tags/pdf.js></script><script class=next-config data-name=mermaid type=application/json>{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/9.1.1/mermaid.min.js","integrity":"sha256-8L3O8tirFUa8Va4NSTAyIbHJeLd6OnlcxgupV9F77e0="}}</script><script src=/js/third-party/tags/mermaid.js></script><script src=/js/third-party/fancybox.js></script><script data-pjax async src=https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><script class=next-config data-name=leancloud_visitors type=application/json>{"enable":true,"app_id":"Q8qpjA3fOO7FEUBqcmcQFptF-gzGzoHsz","app_key":"tgUTq5bX3fVmn916EMRe65eJ","server_url":null,"security":false}</script><script src=/js/third-party/statistics/lean-analytics.js></script><script class=next-config data-name=enableMath type=application/json>false</script><script class=next-config data-name=mathjax type=application/json>{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.1/es5/tex-mml-chtml.js","integrity":"sha256-hlC2uSQYTmPsrzGZTEQEg9PZ1a/+SV6VBCTclohf2og="}}</script><script src=/js/third-party/math/mathjax.js></script><script class=next-config data-name=utterances type=application/json>{"enable":true,"repo":"Winddoing/winddoing.github.io","issue_term":"title","theme":"github-light"}</script><script src=/js/third-party/comments/utterances.js></script></body></html>